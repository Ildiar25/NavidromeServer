<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <record id="music_manager_track_wizard_action" model="ir.actions.act_window">
        <field name="name">Track Wizard</field>
        <field name="res_model">music_manager.track_wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field> <!-- Open as modal form -->
    </record>

    <!-- Track wizard form -->
    <record id="music_manager_track_wizard_view_form" model="ir.ui.view">
        <field name="name">music_manager.track_wizard.view.form</field>
        <field name="model">music_manager.track_wizard</field>
        <field name="arch" type="xml">
            <form string="Track Wizard" disable_autofocus="True">
                <field name="state" string="" widget="statusbar"/>
                <field name="has_valid_path" invisible="True"/>
                <field name="file_path" invisible="True"/>
                <sheet>
                    <!-- Upload song -->
                    <section invisible="state != 'start'">
                        <header>
                            <h1>Welcome! üöÄ </h1>
                        </header>
                        <separator/>
                        <h3 class="text-muted">Ready to upload your next hit? üéß</h3>
                        <p>
                            <em>This is your personal music manager!</em>
                            <br/>
                            <br/>
                            Here you can start building your collection by either uploading an <b>MP3 file</b> from
                            your computer or adding a <b>YouTube link</b> to download and convert it automatically.
                            <br/>
                            Once your song is uploaded, you‚Äôll be able to review and edit its metadata to keep
                            everything tidy and organized.
                            <br/>
                            <br/>
                            <em>Let‚Äôs get started and bring some music to life!</em>
                        </p>
                        <group class="d-flex flex-row justify-content-around">
                            <div class="d-flex flex-column align-items-center mx-3">
                                <img src="music_manager/static/src/img/update-img.png" width="180" height="180" alt="Cloud image"/>
                                <p class="mx-auto"><b>MP3 file</b></p>
                                <div class="align-items-center">
                                    <field name="file" string="MP3 file"/>
                                </div>
                            </div>
                            <div class="d-flex flex-column align-items-center mx-3">
                                <img src="music_manager/static/src/img/youtube-img.png" width="180" height="180" alt="YouTubeimage"/>
                                <p class="mx-auto"><b>YouTube URL</b></p>
                                <div class="align-items-center">
                                    <field name="url" placeholder="https://" tooltip="Insert a URL"/>
                                </div>
                            </div>
                        </group>
                    </section>

                    <!-- Check metadata -->
                    <section invisible="state != 'uploaded'">
                        <header>
                            <h1>Checking! üëÄ </h1>
                        </header>
                        <separator/>
                        <h3 class="text-muted">Here is the metadata founded! üè∑</h3>
                        <p>
                            <b>Metadata</b> is the hidden information embedded inside your music files, such as the
                            title, artist, album, year, genre, and even cover images. These details help music
                            players and libraries like <b>Navidrome</b> to display and organize your songs properly.
                            <br/>
                            <br/>
                            Here we show you what we found in your file!
                            <br/>
                            <br/>
                            <em>Review it carefully before moving forward!</em>
                        </p>
                        <group class="flex-row justify-content-start" style="width: 946px">
                            <group style="border-right: 1px solid #ccc; height: auto; width: 182px">
                                <field name="picture" string="" widget="image" options="{'preview_image': 'picture', 'size': [132, 132]}" readonly="True"/>
                            </group>
                            <group class="flex-grow-1">
                                <group>
                                    <field name="tmp_name" string="Title" readonly="True"/>
                                    <field name="tmp_artists" string="Track artist(s)" readonly="True"/>
                                    <field name="tmp_album" string="Album" readonly="True"/>
                                    <field name="tmp_genre" string="Genre" readonly="True"/>
                                    <field name="tmp_track_no" string="Track" readonly="True"/>
                                    <field name="tmp_disk_no" string="Disk" readonly="True"/>
                                </group>
                                <group>
                                    <field name="tmp_album_artist" string="Album artist" readonly="True"/>
                                    <field name="tmp_original_artist" string="Original artist" readonly="True"/>
                                    <field name="tmp_year" string="Year" readonly="True"/>
                                    <field name="tmp_collection" string="Part of a collection" readonly="True"/>
                                    <field name="tmp_total_track" string="Total track" readonly="True"/>
                                    <field name="tmp_total_disk" string="Total disk" readonly="True"/>
                                </group>
                            </group>
                        </group>
                    </section>

                    <!-- Update metadata -->
                    <section invisible="state != 'metadata'">
                        <header>
                            <h1>Editing! üìù </h1>
                        </header>
                        <separator/>
                        <h3 class="text-muted">Polishing your track details! ‚ú®</h3>
                        <p>
                            You can update or correct the metadata before saving your track on your <b>library</b>.
                            This includes fixing typos, updating the artist name, adding the correct album, or
                            choosing a better genre.
                            <br/>
                            <br/>
                            Keeping your metadata clean ensures that your music collection stays neat and easy to
                            browse across all your devices, including <b>Substreamer</b> and <b>Navidrome</b>.
                            <br/>
                            <br/>
                            <em>Let's do it!</em>
                        </p>
                        <group class="flex-row justify-content-start" style="width: 946px">
                            <group style="border-right: 1px solid #ccc; height: auto; width: 182px">
                                <field name="picture" string="" widget="image" options="{'preview_image': 'picture', 'size': [132, 132]}"/>
                            </group>
                            <group class="flex-grow-1">
                                <group>
                                    <field name="tmp_name" string="Title"/>
                                    <field name="possible_artist_ids" string="Track artist(s)" widget="many2many_tags" placeholder="Select or create artists"/>
                                    <field name="possible_album_id" string="Album" placeholder="Select or create album"/>
                                    <field name="possible_genre_id" string="Genre" placeholder="Select or create genre"/>
                                    <field name="tmp_track_no" string="Track"/>
                                    <field name="tmp_disk_no" string="Disk"/>
                                </group>
                                <group>
                                    <field name="possible_album_artist_id" string="Album artist" placeholder="Select or create album artist"/>
                                    <field name="possible_original_artist_id" string="Original artist" placeholder="Select or create original artist"/>
                                    <field name="tmp_year" string="Year"/>
                                    <field name="tmp_collection" string="Part of a collection"/>
                                    <field name="tmp_total_track" string="Total track"/>
                                    <field name="tmp_total_disk" string="Total disk"/>
                                </group>
                            </group>
                        </group>
                    </section>

                    <!-- Save changes & file -->
                    <section invisible="state != 'done'">
                        <header>
                            <h1>Confirm! ‚úÖ </h1>
                        </header>
                        <separator/>
                        <h3 class="text-muted">Add the file to Navidrome! üíø</h3>
                        <p>
                            When you click on 'Save', the file will be moved to your main music folder used by
                            <b>Navidrome</b>, and the updated metadata will be saved directly inside the audio file.
                            <br/>
                            <br/>
                            This way, your new track will immediately appear in your <b>Navidrome</b> library,
                            ready to be streamed on your PC or mobile app. Once saved, you can still update
                            metadata later from the main form if needed.
                            <br/>
                            <br/>
                            <em>Enjoy it!</em>
                        </p>
                        <group class="flex-row justify-content-start" style="width: 946px">
                            <group style="border-right: 1px solid #ccc; height: auto; width: 182px">
                                <field name="picture" string="" widget="image" options="{'preview_image': 'picture', 'size': [132, 132]}" readonly="True"/>
                            </group>
                            <group class="flex-grow-1">
                                <group>
                                    <field name="tmp_name" string="Title" readonly="True"/>
                                    <field name="possible_artist_ids" string="Track artist(s)" widget="many2many_tags" placeholder="Select or create artists" readonly="True"/>
                                    <field name="possible_album_id" string="Album" placeholder="Select or create album" readonly="True"/>
                                    <field name="possible_genre_id" string="Genre" placeholder="Select or create genre" readonly="True"/>
                                    <field name="tmp_track_no" string="Track" readonly="True"/>
                                    <field name="tmp_disk_no" string="Disk" readonly="True"/>
                                </group>
                                <group>
                                    <field name="possible_album_artist_id" string="Album artist" placeholder="Select or create album artist" readonly="True"/>
                                    <field name="possible_original_artist_id" string="Original artist" placeholder="Select or create original artist" readonly="True"/>
                                    <field name="tmp_year" string="Year" readonly="True"/>
                                    <field name="tmp_collection" string="Part of a collection" readonly="True"/>
                                    <field name="tmp_total_track" string="Total track" readonly="True"/>
                                    <field name="tmp_total_disk" string="Total disk" readonly="True"/>
                                </group>
                            </group>
                        </group>
                        <separator/>
                        <div class="d-flex flex-column align-items-center" invisible="has_valid_path">
                            <h4>My gosh! üôÑ</h4>
                            <p>
                                <em>There are some fields you need to check before save file!</em>
                                <br/>
                                This app needs to have a valid path to add the song into the
                                library folder and we both actually know that condition is not
                                true. Check <b>artist name</b>, <b>album name</b>,
                                <b>track number</b> and <b>track title</b>. All are necessary!
                            </p>
                        </div>
                        <div class="d-flex flex-column align-items-center" invisible="not has_valid_path">
                            <h4>Nice! Your song is ready to be added onto your library! üòç</h4>
                            <p><em>Now it's time! Just click the 'Save' button!</em></p>
                            <button string="Save" type="object" name="save_file" class="btn-outline-success w-50" invisible="not has_valid_path"/>
                        </div>
                    </section>

                    <footer class="d-flex flex-row align-items-center">
                        <button string="Cancel" class="btn-default" special="cancel"/>
                        <div class="ms-auto d-flex gap-2">
                            <button string="Back" type="object" name="action_back" class="btn btn-outline-primary" invisible="state == 'start'"/>
                            <button string="Next" type="object" name="action_next" class="btn btn-outline-primary" invisible="state == 'done'"/>
                        </div>
                    </footer>
                </sheet>
            </form>
        </field>
    </record>
</odoo>